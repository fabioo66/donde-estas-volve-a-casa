<div class="perfil-container">
  <div class="perfil-card">
    <h2>Editar Perfil</h2>

    <form (ngSubmit)="onSubmit()" #perfilForm="ngForm">
      <div class="form-row">
        <div class="form-group">
          <label for="nombreUsuario">Nombre de Usuario *</label>
          <input
            type="text"
            id="nombreUsuario"
            name="nombreUsuario"
            [(ngModel)]="usuario.nombreUsuario"
            required
            class="form-control">
        </div>

        <div class="form-group">
          <label for="email">Correo Electr칩nico *</label>
          <input
            type="email"
            id="email"
            name="email"
            [(ngModel)]="usuario.email"
            required
            email
            class="form-control">
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="nombre">Nombre *</label>
          <input
            type="text"
            id="nombre"
            name="nombre"
            [(ngModel)]="usuario.nombre"
            required
            class="form-control">
        </div>

        <div class="form-group">
          <label for="apellido">Apellido *</label>
          <input
            type="text"
            id="apellido"
            name="apellido"
            [(ngModel)]="usuario.apellido"
            required
            class="form-control">
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="telefono">Tel칠fono *</label>
          <input
            type="tel"
            id="telefono"
            name="telefono"
            [(ngModel)]="usuario.telefono"
            required
            class="form-control">
        </div>

        <div class="form-group">
          <label for="genero">G칠nero *</label>
          <select
            id="genero"
            name="genero"
            [(ngModel)]="usuario.genero"
            required
            class="form-control">
            <option value="">Seleccione...</option>
            <option value="Masculino">Masculino</option>
            <option value="Femenino">Femenino</option>
            <option value="Otro">Otro</option>
            <option value="Prefiero no decir">Prefiero no decir</option>
          </select>
        </div>
      </div>

      <div class="form-group">
        <label for="edad">Edad *</label>
        <input
          type="number"
          id="edad"
          name="edad"
          [(ngModel)]="usuario.edad"
          required
          min="18"
          max="120"
          class="form-control">
      </div>

      <div class="password-section">
        <h3>Cambiar Contrase침a</h3>
        <div class="alert-info">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
          </svg>
          <p>Si deseas cambiar tu contrase침a, completa los siguientes campos. Si no, d칠jalos en blanco.</p>
        </div>

        <div class="password-fields">
          <div class="form-group">
            <label for="passwordActual">Contrase침a Actual</label>
            <input
              type="password"
              id="passwordActual"
              name="passwordActual"
              [(ngModel)]="passwordActual"
              placeholder="Ingresa tu contrase침a actual"
              class="form-control"
              autocomplete="current-password">
            <small class="form-text">Requerida solo si deseas cambiar tu contrase침a</small>
          </div>

          <div class="form-group">
            <label for="passwordNueva">Nueva Contrase침a</label>
            <input
              type="password"
              id="passwordNueva"
              name="passwordNueva"
              [(ngModel)]="passwordNueva"
              minlength="6"
              placeholder="M칤nimo 6 caracteres"
              class="form-control"
              autocomplete="new-password">
          </div>

          <div class="form-group">
            <label for="passwordConfirmar">Confirmar Nueva Contrase침a</label>
            <input
              type="password"
              id="passwordConfirmar"
              name="passwordConfirmar"
              [(ngModel)]="passwordConfirmar"
              minlength="6"
              placeholder="Confirma tu nueva contrase침a"
              class="form-control"
              autocomplete="new-password">
          </div>
        </div>
      </div>

      <div class="ubicacion-section">
        <h3>Ubicaci칩n</h3>
        <button
          type="button"
          class="btn-ubicacion"
          (click)="obtenerUbicacionActual()"
          [disabled]="loadingUbicacion">
          <span *ngIf="!loadingUbicacion">游늸 Actualizar Ubicaci칩n</span>
          <span *ngIf="loadingUbicacion">Obteniendo ubicaci칩n...</span>
        </button>

        <div class="form-row">
          <div class="form-group">
            <label for="provincia">Provincia *</label>
            <input
              type="text"
              id="provincia"
              name="provincia"
              [(ngModel)]="usuario.provincia"
              required
              class="form-control">
          </div>

          <div class="form-group">
            <label for="municipio">Municipio *</label>
            <input
              type="text"
              id="municipio"
              name="municipio"
              [(ngModel)]="usuario.municipio"
              required
              class="form-control">
          </div>
        </div>

        <div class="form-group">
          <label for="departamento">Departamento *</label>
          <input
            type="text"
            id="departamento"
            name="departamento"
            [(ngModel)]="usuario.departamento"
            required
            class="form-control">
        </div>
      </div>

      <div class="success-message" *ngIf="successMessage">
        {{ successMessage }}
      </div>

      <div class="error-message" *ngIf="errorMessage">
        {{ errorMessage }}
      </div>

      <div class="button-group">
        <button
          type="submit"
          class="btn-primary"
          [disabled]="loading || !perfilForm.valid">
          <span *ngIf="!loading">Guardar Cambios</span>
          <span *ngIf="loading">Guardando...</span>
        </button>

        <button
          type="button"
          class="btn-secondary"
          routerLink="/home">
          Cancelar
        </button>

        <button
          type="button"
          class="btn-danger"
          (click)="cerrarSesion()">
          Cerrar Sesi칩n
        </button>
      </div>
    </form>
  </div>
</div>
